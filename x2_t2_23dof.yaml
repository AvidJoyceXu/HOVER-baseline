# @package _global_

defaults:
  - robot_base

robot:
  body_names: [
          'pelvis', # 把fixed joint合并了，在retarget的时候是否会有问题啊

          'left_hip_pitch_link', 
          'left_hip_roll_link',
          'left_hip_yaw_link',
          'left_knee_link', 
          'left_ankle_pitch_link', 
          'left_ankle_roll_link', 

          'right_hip_pitch_link', 
          'right_hip_roll_link',
          'right_hip_yaw_link',
          'right_knee_link', 
          'right_ankle_pitch_link', 
          'right_ankle_roll_link', 

          "waist_yaw_link",
          "waist_pitch_link",
          "waist_roll_link",

          'left_shoulder_pitch_link',
          'left_shoulder_roll_link',
          'left_shoulder_yaw_link',
          'left_elbow_pitch_link', 
          # 'left_wrist_yaw_link', 
          # 'left_wrist_pitch_link', 
          # 'left_wrist_roll_link', 

          'right_shoulder_pitch_link',
          'right_shoulder_roll_link',
          'right_shoulder_yaw_link',
          'right_elbow_pitch_link', 
          # 'right_wrist_yaw_link', 
          # 'right_wrist_pitch_link', 
          # 'right_wrist_roll_link', 

          # 'head_yaw_link',
          # 'head_pitch_link',
          ]
  dof_names: ['left_hip_pitch_joint', 
            'left_hip_roll_joint', 
            'left_hip_yaw_joint', 
            'left_knee_joint',
            'left_ankle_pitch_joint',
            'left_ankle_roll_joint',

            'right_hip_pitch_joint', 
            'right_hip_roll_joint', 
            'right_hip_yaw_joint', 
            'right_knee_joint',
            'right_ankle_pitch_joint',
            'right_ankle_roll_joint',

            'waist_yaw_joint',
            'waist_pitch_joint',
            'waist_roll_joint',

            'left_shoulder_pitch_joint', 
            'left_shoulder_roll_joint',
            'left_shoulder_yaw_joint',
            'left_elbow_pitch_joint',
            # 'left_wrist_yaw_joint',     # fixed
            # 'left_wrist_pitch_joint',   # fixed
            # 'left_wrist_roll_joint',    # fixed

            'right_shoulder_pitch_joint', 
            'right_shoulder_roll_joint',
            'right_shoulder_yaw_joint',
            'right_elbow_pitch_joint',
            # 'right_wrist_yaw_joint',    # fixed
            # 'right_wrist_pitch_joint',  # fixed
            # 'right_wrist_roll_joint',   # fixed
            ]

  num_bodies: 24
  dof_obs_size: 23
  actions_dim: 23
  lower_body_actions_dim: 15 
  upper_body_actions_dim: 8 
  policy_obs_dim: -1 
  critic_obs_dim: -1

  upper_dof_names: ['left_shoulder_pitch_joint', 'left_shoulder_roll_joint', 'left_shoulder_yaw_joint', 'left_elbow_pitch_joint',
              'right_shoulder_pitch_joint', 'right_shoulder_roll_joint', 'right_shoulder_yaw_joint', 'right_elbow_pitch_joint']
  upper_left_arm_dof_names: ['left_shoulder_pitch_joint', 'left_shoulder_roll_joint', 'left_shoulder_yaw_joint', 'left_elbow_pitch_joint']
  upper_right_arm_dof_names: ['right_shoulder_pitch_joint', 'right_shoulder_roll_joint', 'right_shoulder_yaw_joint', 'right_elbow_pitch_joint']
  lower_dof_names: ['left_hip_pitch_joint', 'left_hip_roll_joint', 'left_hip_yaw_joint', 'left_knee_joint', 'left_ankle_pitch_joint', 'left_ankle_roll_joint',
              'right_hip_pitch_joint', 'right_hip_roll_joint', 'right_hip_yaw_joint', 'right_knee_joint', 'right_ankle_pitch_joint', 'right_ankle_roll_joint',
              'waist_yaw_joint', 'waist_pitch_joint', 'waist_roll_joint']
  waist_dof_names: ['waist_yaw_joint', 'waist_pitch_joint', 'waist_roll_joint']


  key_bodies: ["left_ankle_roll_link", "right_ankle_roll_link"]
  contact_bodies: [ "left_ankle_roll_link", "right_ankle_roll_link" ]
  num_feet: 2
  right_foot_name: "right_ankle_roll_link"
  left_foot_name: "left_ankle_roll_link"
  foot_name: "ankle_roll_link"
  knee_name: "knee_link"
  has_torso: True
  torso_name: "waist_roll_link"
  has_upper_body_dof: True

  dof_pos_lower_limit_list: [-2.556, -0.235, -1.685, 0, -0.803, -0.262,  -2.556, -2.906, -3.43, 0, -0.803, -0.262,       -3.43, -0.314, -0.488,    -2.556, -0.061, -2.556, -2.556,     -2.556, -2.993, -2.556, -2.556]
  dof_pos_upper_limit_list: [2.556, 2.967, 3.43, 2.12, 0.453, 0.262,     2.556, 0.235, 1.685, 2.12, 0.453, 0.262,        2.382, 0.314, 0.488,      2.556, 2.993, 2.556, 0,             2.556, 0.061, 2.556, 0]
  
  # only apply for isaacsim
  # dof_armature_list: [0.03, 0.03, 0.03, 0.03, 0.03, 0.03,
  #                     0.03, 0.03, 0.03, 0.03, 0.03, 0.03,
  #                     0.03, 0.03, 0.03,
  #                     0.03, 0.03, 0.03, 0.03,
  #                     0.04, 0.03, 0.03, 0.03]
  # # only apply for isaacsim
  # dof_joint_friction_list: [0.03, 0.03, 0.03, 0.03, 0.03, 0.03,
  #                           0.03, 0.03, 0.03, 0.03, 0.03, 0.03,
  #                           0.03, 0.03, 0.03,
  #                           0.03, 0.03, 0.03, 0.03,
  #                           0.03, 0.03, 0.03, 0.03]

  # trackable_bodies_subset: ['pelvis', 'head_link', 'left_ankle_roll_link', 'right_ankle_roll_link', 'left_wrist_pitch_link', 'right_wrist_pitch_link']

  # 观察参数
  # dof_obs_size: 23
  # number_of_actions: 29
  # self_obs_max_coords_size: 358  # ${eval:1+31*(3+6+3+3)-3}

  # 控制参数
  # dof_body_ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
  dof_effort_limit_list: [120,  120,  120,  120,  36,   24,      120,  120,  120,  120,  36,   24,      120,  48, 48,    36, 36, 24, 24,    36, 36, 24, 24]
  dof_vel_limit_list: [   11.9, 11.9, 11.9, 11.9, 13.0, 19.7,    11.9, 11.9, 11.9, 11.9, 13.0, 19.7,    11.9, 13, 13,    13, 13, 15, 15,    13, 13, 15, 15]
  # dof_armature_list: [0.036864, 0.01, 0.036864, 0.01, 0.01, 0.01, 0.036864, 0.01, 0.036864, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.036864, 0.331776, 0.01, 0.01, 0.036864, 0.331776]
  # dof_joint_friction_list: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]

  # key_bodies: ["left_foot_link", "right_foot_link", "left_wrist_pitch_link", "right_wrist_pitch_link"]
  # non_termination_contact_bodies: ["left_foot_link", "left_ankle_roll_link", "right_foot_link", "right_ankle_roll_link"]
  # right_foot_name: "right_foot_link"
  # left_foot_name: "left_foot_link"
  # head_body_name: "left_hip_pitch_link"
  terminate_after_contacts_on : [] # ["pelvis", "shoulder", "hip"]
  penalize_contacts_on: ["pelvis", "shoulder", "hip", "torso", "waist", "elbow", 'knee']

  init_state:
    pos: [0.0, 0.0, 0.68] # x,y,z [m]
    rot: [0.0, 0.0, 0.0, 1.0] # x,y,z,w [quat] 
    lin_vel: [0.0, 0.0, 0.0]  # x,y,z [m/s]
    ang_vel: [0.0, 0.0, 0.0]  # x,y,z [rad/s]
    default_joint_angles: # = target angles [rad] when action = 0.0
      # 左腿关节
      left_hip_pitch_joint: 0.0
      left_hip_roll_joint: 0.0
      left_hip_yaw_joint: 0.0
      left_knee_joint: 0.4
      left_ankle_pitch_joint: -0.2
      left_ankle_roll_joint: 0.0
      # 右腿关节
      right_hip_pitch_joint: 0.0
      right_hip_roll_joint: 0.0
      right_hip_yaw_joint: 0.0
      right_knee_joint: 0.4
      right_ankle_pitch_joint: -0.2
      right_ankle_roll_joint: 0.0
      # 躯干和头部关节
      waist_yaw_joint: 0.0
      waist_pitch_joint: 0.0
      waist_roll_joint: 0.0
      # 左臂关节
      left_shoulder_pitch_joint: 0.0
      left_shoulder_roll_joint: 0.0
      left_shoulder_yaw_joint: 0.0
      left_elbow_pitch_joint: 0.0
      # 右臂关节
      right_shoulder_pitch_joint: 0.0
      right_shoulder_roll_joint: 0.0
      right_shoulder_yaw_joint: 0.0
      right_elbow_pitch_joint: 0.0
      

  control:
    control_type: P
    # PD驱动参数:
    stiffness: # [N*m/rad]
      hip_pitch: 160
      hip_roll: 160
      hip_yaw: 160
      knee: 220
      ankle_pitch: 80
      ankle_roll: 80
      
      waist_yaw: 200 # 50
      waist_pitch: 120 # 50
      waist_roll: 120 # 50

      shoulder_pitch: 120
      shoulder_roll: 120
      shoulder_yaw: 120
      elbow_pitch: 120
      
    damping: # [N*m*s/rad]
      hip_pitch: 2.0
      hip_roll: 2.0
      hip_yaw: 2.0
      knee: 4.0
      ankle_pitch: 2.0
      ankle_roll: 2.0

      waist_yaw:    5.0
      waist_pitch:  5.0
      waist_roll:   5.0

      shoulder_pitch: 2.0
      shoulder_roll: 2.0
      shoulder_yaw: 2.0
      elbow_pitch: 2.0


    # action scale: target angle = actionScale * action + defaultAngle
    action_scale: 0.25
    action_clip_value: 100.0
    clip_torques: True
      

  asset:
    collapse_fixed_joints: True
    replace_cylinder_with_capsule: False
    flip_visual_attachments: False
    armature: 0.001   #这是干啥的
    thickness: 0.01
    max_angular_velocity: 1000.
    max_linear_velocity: 1000.
    density: 0.001
    angular_damping: 0.
    linear_damping: 0.

    urdf_file: "x2_t2/urdf/x2_t2_jw_collision_kungfu.urdf"
    # urdf_file: "x2_t1/x2_t1_23dof_final.urdf"
    # usd_file: "x2_t1/${robot.asset.robot_type}.usd"
    xml_file: "x2_t2/mjcf_mc/x2_mc_kungfu.xml"
    # xml_file: "x2_t1/x2_t1_23dof_final.xml"
    robot_type: x2_t2_23dof
    self_collisions: 0
    default_dof_drive_mode: 3
    fix_base_link: False # TEST: fix base link to world


# 覆盖运动库默认值以使用适配的X2变体
  motion:
    motion_lib_type: 'WTS'
    motion_file : null
    motion_folder: ???
    asset:
      assetRoot: "description/robots/x2_t2/mjcf_mc"
      assetFileName: "x2_mc_kungfu.xml"

    humanoid_type: x2_t2_23dof
    bias_offset: False
    has_self_collision: True
    has_mesh: False
    has_jt_limit: False
    has_dof_subset: True
    has_upright_start: True
    has_smpl_pd_offset: False
    remove_toe: False # For humanoid's geom toe
    motion_sym_loss: False
    sym_loss_coef: 1
    big_ankle: True

    has_shape_obs: false
    has_shape_obs_disc: false
    has_shape_variation: False

    masterfoot: False
    freeze_toe: false
    freeze_hand: False
    box_body: True
    real_weight: True
    real_weight_porpotion_capsules: True
    real_weight_porpotion_boxes: True

    body_names: ['pelvis',
              'left_hip_pitch_link', 'left_hip_roll_link', 'left_hip_yaw_link', 'left_knee_link', 'left_ankle_pitch_link', 'left_ankle_roll_link',
              'right_hip_pitch_link', 'right_hip_roll_link', 'right_hip_yaw_link', 'right_knee_link', 'right_ankle_pitch_link', 'right_ankle_roll_link',
              'waist_yaw_link', 'waist_pitch_link', 'waist_roll_link',
              'left_shoulder_pitch_link', 'left_shoulder_roll_link', 'left_shoulder_yaw_link', 'left_elbow_pitch_link',
              'right_shoulder_pitch_link', 'right_shoulder_roll_link', 'right_shoulder_yaw_link', 'right_elbow_pitch_link']
          
    limb_weight_group: 
    - [ 'left_hip_pitch_link', 'left_hip_roll_link', 'left_hip_yaw_link', 'left_knee_link', 'left_ankle_pitch_link', 'left_ankle_roll_link' ]
    - [ 'right_hip_pitch_link', 'right_hip_roll_link', 'right_hip_yaw_link', 'right_knee_link', 'right_ankle_pitch_link', 'right_ankle_roll_link' ]
    - [ 'pelvis', 'waist_yaw_link', 'waist_pitch_link', 'waist_roll_link' ]
    - [ 'left_shoulder_pitch_link', 'left_shoulder_roll_link', 'left_shoulder_yaw_link', 'left_elbow_pitch_link' ]
    - [ 'right_shoulder_pitch_link', 'right_shoulder_roll_link', 'right_shoulder_yaw_link', 'right_elbow_pitch_link' ]

    dof_names: ['left_hip_pitch_link', 'left_hip_roll_link', 'left_hip_yaw_link', 'left_knee_link', 'left_ankle_pitch_link', 'left_ankle_roll_link', 
                'right_hip_pitch_link', 'right_hip_roll_link', 'right_hip_yaw_link', 'right_knee_link', 'right_ankle_pitch_link', 'right_ankle_roll_link', 
                'waist_yaw_link', 'waist_pitch_link', 'waist_roll_link',
                'left_shoulder_pitch_link', 'left_shoulder_roll_link', 'left_shoulder_yaw_link', 'left_elbow_pitch_link',
                'right_shoulder_pitch_link', 'right_shoulder_roll_link', 'right_shoulder_yaw_link', 'right_elbow_pitch_link']



    # right_foot_name: 'right_foot_link'
    # left_foot_name: 'left_foot_link'

    # right_foot_name: "right_ankle_roll_link"
    # left_foot_name: "left_ankle_roll_link"

    # right_foot_name: 'right_foot_link'
    # left_foot_name: 'left_foot_link'


    nums_extend_bodies: 3
    extend_config:
    - joint_name: "left_hand_link"
      parent_name: "left_elbow_pitch_link"
      pos: [ 0.0, 0.0, -0.21 ]
      rot: [ 1.0, 0.0, 0.0, 0.0 ] # w x y z
    - joint_name: "right_hand_link"
      parent_name: "right_elbow_pitch_link"
      pos: [ 0.0, 0.0, -0.21 ]
      rot: [ 1.0, 0.0, 0.0, 0.0 ] # w x y z
    - joint_name: "head_link"
      parent_name: "waist_roll_link"
      pos: [ 0.0, 0.0, 0.4 ]
      rot: [ 1.0, 0.0, 0.0, 0.0 ] # w x y z


    motion_tracking_link:
      - "left_hand_link"
      - "right_hand_link"
      # - "pelvis"
      - "head_link"

    lower_body_link:
      - "pelvis"
      - "left_hip_pitch_link"
      - "left_hip_roll_link"
      - "left_hip_yaw_link"
      - "left_knee_link"
      - "left_ankle_pitch_link"
      - "left_ankle_roll_link"
      - "right_hip_pitch_link"
      - "right_hip_roll_link"
      - "right_hip_yaw_link"
      - "right_knee_link"
      - "right_ankle_pitch_link"
      - "right_ankle_roll_link"
      - "waist_yaw_link"
      - "waist_pitch_link"
      - "waist_roll_link"

    upper_body_link:
      - "left_shoulder_pitch_link"
      - "left_shoulder_roll_link"
      - "left_shoulder_yaw_link"
      - "left_elbow_pitch_link"
      - "right_shoulder_pitch_link"
      - "right_shoulder_roll_link"
      - "right_shoulder_yaw_link"
      - "right_elbow_pitch_link"
      - "left_hand_link"
      - "right_hand_link"
      - "head_link"


    pelvis_link: "pelvis"
    base_link: "pelvis"
    hips_link:
      - "left_hip_pitch_link"
      - "left_hip_roll_link"
      - "left_hip_yaw_link"
      - "right_hip_pitch_link"
      - "right_hip_roll_link"
      - "right_hip_yaw_link"
    
    joint_matches:
      - [ "pelvis", "Pelvis" ]
      - [ "left_hip_pitch_link", "L_Hip" ]
      - [ "left_knee_link", "L_Knee" ]
      - [ "left_ankle_pitch_link", "L_Ankle" ]
      - [ "right_hip_pitch_link", "R_Hip" ]
      - [ "right_knee_link", "R_Knee" ]
      - [ "right_ankle_pitch_link", "R_Ankle" ]
      - [ "left_shoulder_pitch_link", "L_Shoulder" ]
      - [ "left_elbow_pitch_link", "L_Elbow" ]
      - [ "left_hand_link", "L_Hand" ]
      - [ "right_shoulder_pitch_link", "R_Shoulder" ]
      - [ "right_elbow_pitch_link", "R_Elbow" ]
      - [ "right_hand_link", "R_Hand" ]
      - [ "head_link", "Head"]


    smpl_pose_modifier:
      - Pelvis: "[np.pi/2, 0, np.pi/2]"
      - L_Shoulder: "[0, 0, -np.pi/2]"
      - R_Shoulder: "[0, 0, np.pi/2]"
      - L_Elbow: "[0, -np.pi/2, 0]"
      - R_Elbow: "[0, np.pi/2, 0]"

    visualization:
      customize_color : True
      marker_joint_colors : 
      - [0.929, 0.867, 0.437] # pelvis

      - [0.929, 0.867, 0.437] # left_hip_yaw_joint
      - [0.929, 0.867, 0.437] # left_hip_roll_joint
      - [0.929, 0.867, 0.437] # left_hip_pitch_joint
      - [0.929, 0.867, 0.437] # left_knee_joint
      - [0.929, 0.867, 0.437] # left_ankle_pitch_joint
      - [0.929, 0.867, 0.437] # left_ankle_roll_joint

      - [0.929, 0.867, 0.437] # right_hip_yaw_joint
      - [0.929, 0.867, 0.437] # right_hip_roll_joint
      - [0.929, 0.867, 0.437] # right_hip_pitch_joint
      - [0.929, 0.867, 0.437] # right_knee_joint
      - [0.929, 0.867, 0.437] # right_ankle_pitch_joint
      - [0.929, 0.867, 0.437] # right_ankle_roll_joint

      - [0.929, 0.867, 0.437] # waist_yaw_joint
      - [0.929, 0.867, 0.437] # waist_roll_joint
      - [0.929, 0.867, 0.437] # torso_joint (waist_pitch_link)

      - [0.929, 0.867, 0.437] # left_shoulder_pitch_joint
      - [0.929, 0.867, 0.437] # left_shoulder_roll_joint
      - [0.929, 0.867, 0.437] # left_shoulder_yaw_joint
      - [0.929, 0.867, 0.437] # left_elbow_joint

      - [0.929, 0.867, 0.437] # right_shoulder_pitch_joint
      - [0.929, 0.867, 0.437] # right_shoulder_roll_joint
      - [0.929, 0.867, 0.437] # right_shoulder_yaw_joint
      - [0.929, 0.867, 0.437] # right_elbow_joint

      - [0, 0.351, 0.613] # left_elbow_joint_extend
      - [0, 0.351, 0.613] # right_elbow_joint_extend
      
      - [0, 0.351, 0.613] # head_link




# 覆盖模拟配置以使用适配的X2变体
